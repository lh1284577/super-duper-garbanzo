{% extends "adminlte/base.html" %}
{% block content %}
<head>
	<link href="media/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/style-metro.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/style.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/style-responsive.css" rel="stylesheet" type="text/css"/>
	<link href="media/css/default.css" rel="stylesheet" type="text/css" id="style_color"/>
	<link href="media/css/uniform.default.css" rel="stylesheet" type="text/css"/>


  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/ionicons.min.css">
  <link rel="stylesheet" href="plugins/select2/select2.min.css">
  <link rel="stylesheet" href="dist/css/AdminLTE.min.css">

<style>
.pace {
  -webkit-pointer-events: none;
  pointer-events: none;

  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

.pace-inactive {
  display: none;
}

.pace .pace-progress {
  background: #29d;
  position: fixed;
  z-index: 2000;
  top: 0;
  right: 100%;
  width: 100%;
  height: 2px;
}
</style>


</head>
<body class="page-header-fixed">
	<div >
		<div class="navbar-inner">
			<div class="container-fluid">
				<!-- BEGIN PAGE HEADER-->   
				<div class="row-fluid">
					<div >
        					<div >
							<section class="content-header">
      								<h1>
        								<small></small>
      								</h1>
      								<ol class="breadcrumb">
        								<li><a href="/admin"><i class="fa fa-dashboard"></i> Home</a></li>
        								<li><a href="#">Artifactory</a></li>
        								<li><a href="#">上传SDK</a></li>
      								</ol>
    							</section>
						</div>
				<!-- END PAGE HEADER-->
				<!-- BEGIN PAGE CONTENT-->
				<div class="row-fluid">
					<div class="span12">
						<!-- BEGIN SAMPLE FORM PORTLET-->   
						<div class="portlet box blue">
							<div class="portlet-title">
								<div class="caption"><i class="icon-reorder"></i>上传SDK</div>
							</div>



							<div class="portlet-body form">
								<form method="get"  target=domain   action="http://restart.uletm.com/pushsdk.php" class="form-horizontal" id=lihao>
									<div class="control-group">
										<label class="control-label">组ID</label>
										<div class="controls">
											<input type="text"  name=groupid class="span6 m-wrap" />
											<span class="help-inline"></span>
										</div>
									</div>

									<div class="control-group">
										<label class="control-label">Artifactid</label>
										<div class="controls">
											<input name=artifactid type="text" class="span6 m-wrap tooltips" data-trigger="hover" data-original-title="注：tomcat 业务端口,例:8009" />                       
										</div>
									</div>

									<div class="control-group">
										<label class="control-label">版本</label>
										<div class="controls">
											<input name=version type="text" class="span6 m-wrap tooltips" data-trigger="hover" data-original-title="注：tomcat 业务端口,例:8009" />                       
										</div>
									</div>


									

									<div class="control-group">
									    <section >
											<label class="control-label">URL</label>
									              <div class="controls">
											<select class="span6 select2" multiple="multiple" name=env data-placeholder="Select a State" id='system'>
									                  <option name=chkItem type="checkbox"   value='dev'>dev</option>
									                  <option name=chkItem type="checkbox"  value='beta'>beta</option>
									                  <option name=chkItem type="checkbox"  value='prd'>prd</option>
									                </select>
									            </div>
									    </section>
									</div>



									<div class="control-group">
										<label class="control-label">File</label>
										<div class="controls">
											<input name=file type="text" class="span6 m-wrap tooltips" id=putfile data-trigger="hover" readonly="readonly" />                       
										</div>
									</div>


	
									<div >
										<p><td colspan="10" >执行结果如下:</td></p>
										<iframe  name='domain' valign="bottom" align="right"  width="100%" height="200" frameborder=0 scrolling=auto></iframe>
									</div>


									<div class="form-actions">
										<button type="submit" id='tub' class="btn blue">Submit</button>
										<button type="reset"  class="btn">Cancel</button>                            
									</div>
								</form>
								<!-- END FORM-->       
							</div>
						</div>
						<!-- END SAMPLE FORM PORTLET-->
					</div>
				</div>
			</div>
            <form  target='nm_iframe' enctype="multipart/form-data" name='form' role="form">
                {% csrf_token %}
                <div class="form-group">
			<table>
		<tr><td>
                  <input type="file" name='Picture' id=file >
		</td><td>
                  <button style='background-color:#d0d0d0;border-color:#d0d0d0' id="exampleInputFile" type="submit" class="btn btn-primary ajax">Submit</button>
		</td></tr>
			</table>
                  <p style='color:red' class="help-block">
保存地址：/data/postmall/apache/software</p>
                </div>
              </div>
            </form>
<iframe id="id_iframe" name="nm_iframe" style="display:none;"></iframe> 
		<!-- END PAGE CONTAINER-->
		</div>
	</div>
	</div>
	</div>

        <script src="media/js/jquery-1.10.1.min.js" type="text/javascript"></script>
        <script src="media/js/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
        <script src="media/js/app.js"></script>


{%block jssdk%}
<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script src="plugins/select2/select2.full.min.js"></script>
<script src="js/pace.min.js"></script>
{%endblock%}
<script>
  $(function () {
    //Initialize Select2 Elements
    $(".select2").select2();

    //Datemask dd/mm/yyyy
    //Money Euro

    //Date range picker
    $('#reservation').daterangepicker();
    //Date range picker with time picker
    $('#reservationtime').daterangepicker({timePicker: true, timePickerIncrement: 30, format: 'MM/DD/YYYY h:mm A'});
    //Date range as a button

    //Date picker
    $('#datepicker').datepicker({
      autoclose: true
    });



  });


$('#exampleInputFile').click(function(){
	var fileName = document.getElementById("file").value;
	var Name = fileName.replace(/(.*)\\(.*)\\(.*)/,'$3')
	$(this).css("background-color","#0362fd");
	$(this).css("border-color","#0362fd");
	$("input[name='file']").val(Name);
	


});


$('#tub').click(function(){
	re = new RegExp("×", "g");
	a = $('.select2-selection__rendered').text().replace(re,'')
	var chk_value =[]; 
	chk_value.push($('option[name="chkItem"]:checked').val(a))
});


</script>


<script type="text/javascript">
        $('.ajax').click(function(){

        		var file = document.getElementById('file').files[0];
        		if (file) {

        		          $('.ajax').html('正在加载，耐心等待 !');
        		          $('.ajax').removeClass('btn-success').addClass("btn-warning");

      				  var fd = new FormData();
      				  fd.append("Picture", document.getElementById('file').files[0]);
      				  var xhr = new XMLHttpRequest();

      				  xhr.addEventListener("load", uploadComplete, false);
      				  xhr.addEventListener("error", uploadFailed, false);
      				  xhr.addEventListener("abort", uploadCanceled, false);

      				  xhr.open("POST", "/admin/putfile",true);
      				  xhr.setRequestHeader('X-CSRFTOKEN','{{ request.COOKIES.csrftoken }}');
      				  xhr.send(fd);
        		}else{
				alert("请先上传文件！");
				}

        });

      function uploadComplete(evt) {
        /* 当服务器响应后，这个事件就会被触发 */
        //alert(evt.target.responseText);
        document.getElementById('exampleInputFile').innerHTML = '上传成功';

      }

      function uploadFailed(evt) {
        alert("上传文件发生了错误尝试");
      }

      function uploadCanceled(evt) {
        alert("上传被用户取消或者浏览器断开连接");
      }

</script>


</body>
{% endblock %}
